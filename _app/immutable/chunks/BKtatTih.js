import{A as B,U as H,P as O}from"./CzRjdjXF.js";import{o as Q}from"./CMvIGskt.js";const C=["👍","👎"],se=r=>`${r[0].toUpperCase()}${r.slice(1)}`,Y=(...r)=>r.map((e,t)=>{if(typeof e!="string")return"";let n=e.replace(/\/+$/,"");return t!==0&&(n=n.replace(/^\/+/,"")),n}).filter(e=>e.length>0).join("/"),ne=(...r)=>Y("https://bld-server.pux.one",...r),ie=r=>{const[e,...t]=r.split("");return[e.toLocaleUpperCase(),...t].join("")},I=r=>{const e=r?new Headers(r):new Headers,t=localStorage.getItem(B),n=localStorage.getItem(H),m=localStorage.getItem(O);return!n||!m?{headers:e,isValid:!1,previousAccessToken:null}:(t&&e.append("x-access-token",t),e.append("x-username",n),e.append("x-password",m),{headers:e,isValid:!0,previousAccessToken:t})},le=r=>{const e=new Date;e.setHours(0),e.setMinutes(0),e.setSeconds(0);const t=new Date(r);t.setHours(0),t.setMinutes(0),t.setSeconds(0);const n=(e.valueOf()-t.valueOf())/(1e3*60*60*24);return n<1?"Today":n<2?`${n.toFixed(0)} Day ago`:`${n.toFixed(0)} Days ago`},oe=(r,e)=>{const t={...e},{headers:n,isValid:m,previousAccessToken:h}=I(e?.headers);m&&(t.headers=n);const S=fetch(r,{mode:"cors",...t});return S.then(c=>{if(c.ok){Q.update(s=>({...s,isUserAuthenticated:!0}));const p=c.headers.get("X-Access-Token");p&&h!==p&&localStorage.setItem(B,p)}return c}),S},V=(r,e)=>{const t=r.split("");if(t.length!==2||t[0]===t[1])return!1;for(let n=0;n<e.length;n++)if(e[n].includes(t[0])&&e[n].includes(t[1]))return!0;return!1},K=(r,e)=>{const t=r.split("");for(let n=0;n<t.length;n++)if(e.includes(t[n]))return!0;return!1},ae=()=>navigator.userAgent.includes("Win")?"win":navigator.userAgent.includes("Mac")?"mac":"",T=r=>r.replaceAll(/  +/g," ").replaceAll(/ *([ufrdlb])/gi," $1").replaceAll(/ *\[ */g,"[").replaceAll(/ *\] */g,"]").replaceAll(/ *, */g,",").replaceAll(/ *: */g,":").replaceAll(/ *\/ */g,"/").trim(),A=r=>{const e=r.split(" ").filter(t=>t).reverse();for(let t=0;t<e.length;t++)e[t].includes("2")||(e[t].includes("'")?e[t]=e[t].replaceAll("'",""):e[t]=`${e[t]}'`);return e.join(" ")},N="R U R' F' R U R' U' R' F R2 U' R' U'",q="R U R' U' R' F R2 U' R' U' R U R' F'",z="R' F R2 U' R' U' R U R' F' R U R' U'",y="L' U' L F L' U' L U L F' L2 U L U",J=`F ${z} F'`,X=r=>r.replaceAll(/<jb-perm>/gi,N).replaceAll(/<op-swap>/gi,z).replaceAll(/<left jb-perm>/gi,y).replaceAll(/<ljb-perm>/gi,y).replaceAll(/<t-perm>/gi,q).replaceAll(/<y-perm>/gi,J),Z=r=>{const e=X(r),t=r!==e;let n="";for(let c=0;c<C.length;c++)if(e.includes(C[c])){n=`${C[c]} `;break}const m=e.match(/\[[ufrdlb2' ]+,[ufrdlb2' ]+\]/i);if(m){const c=T(m[0]);let p=c;const s=e.match(/[ufrdlb2' ]+: ?\[[ufrdlb2' ]+,[ufrdlb2' ]+\]/i);let i="";s&&(p=T(s[0]),i=p.split(":")[0].trim());let a="",x="";const M=c.replaceAll("[","").replaceAll("]","").split(",").map(D=>D.trim());return a=M[0],x=M[1],M[0].match(/^[ufrdlb][2']*$/i)&&(x=M[0],a=M[1]),p[0]!=="["&&(p=`[${p}]`),{rawCommutator:r,normalisedCommutator:t?r:p,commutator:c,conjugatePlusCommutator:p,setup:i,insert:a,insertLength:a.split(" ").length,interchange:x,regripEmoji:n,expansion:[i,M[0],M[1],A(M[0]),A(M[1]),A(i)].filter(D=>D).join(" ")}}const h=e.match(/(?<setupRG>[ufrdlb2' ]+:)? *(?<commutatorRG>\[[ufrdlb]'?\/[ufrdlb2' ]+\])/i);if(h){const{setupRG:c,commutatorRG:p}=h.groups||{},[s,i]=p.replaceAll("[","").replaceAll("]","").split("/"),a=s.trim(),x=`${a.replaceAll("'","")}2`,M=T(p),D=c?T(c.replaceAll(":","")):"";let F=M;return D&&(F=`[${D}:${M}]`),{rawCommutator:r,normalisedCommutator:t?r:F,commutator:M,conjugatePlusCommutator:F,setup:D,insert:i,insertLength:i.split(" ").length,interchange:x,expansion:[D,a,i,x,A(i),a,A(D)].filter(j=>j).join(" ")}}const S=e.match(/(?<setupRG>[ufrdlb2' ]+) *: *(?<algorithmRG>[ufrdlb2' ]+)/i);if(S){const{setupRG:c,algorithmRG:p}=S.groups||{},s=c?T(c):"",i=p?T(p):"";return{rawCommutator:r,normalisedCommutator:t?r:`[${s}:${i}]`,commutator:"",conjugatePlusCommutator:"",setup:s,insert:"",insertLength:0,interchange:"",expansion:[s,i,A(s)].filter(a=>a).join(" ")}}return{rawCommutator:r,normalisedCommutator:r,commutator:"",conjugatePlusCommutator:"",setup:"",insert:"",insertLength:0,interchange:"",expansion:e}},ce=r=>{const e=r.split(" ").filter(s=>s),t=e.map(s=>({move:s,type:"normal"})),n=[],m=e.map((s,i)=>({move:s,face:s.replaceAll("'","").replaceAll("2",""),amount:s.includes("'")?3:s.includes("2")?2:1,type:"normal",steps:[i]}));let h=m.map(s=>s.move).join(" "),S="";for(;S!==h;)S=h,m.sort((s,i)=>s.move.startsWith("U")&&i.move.startsWith("D")?-1:s.move.startsWith("D")&&i.move.startsWith("U")?1:s.move.startsWith("F")&&i.move.startsWith("B")?-1:s.move.startsWith("B")&&i.move.startsWith("F")?1:s.move.startsWith("R")&&i.move.startsWith("L")?-1:s.move.startsWith("L")&&i.move.startsWith("R")?1:0),h=m.map(s=>s.move).join(" ");m.forEach(s=>{if(n.length===0){n.push(s);return}let i=n.length-1;for(let a=n.length-1;a>=0;a--)if(n[a].amount!==0){i=a;break}if(n[i].face===s.face){n[i].amount=(n[i].amount+s.amount)%4,n[i].type="cancelled",n[i].steps.push(...s.steps);return}n.push(s)});const c=n.map(s=>{switch(s.type==="cancelled"&&s.steps.forEach(i=>{t[i].type="cancelled"}),s.amount){case 0:return s.steps.forEach(i=>{t[i].type="gone"}),{...s,move:""};case 1:return{...s,move:`${s.face}`};case 2:return{...s,move:`${s.face}2`};case 3:return{...s,move:`${s.face}'`};default:return console.warn("step",s),alert("Invalid move. See console for details"),{...s,move:""}}}).filter(s=>s.move),p=c.map(s=>s.move);return{original:t,simplified:c,simplifiedString:p.join(" "),originalCount:e.length,simplifiedCount:p.length}},ue=(r,e)=>{const t=r.trim().split(" ").filter(m=>m),n=e.trim().split(" ").filter(m=>m);return t.length!=n.length?n.length-t.length:r.localeCompare(e)},me=r=>r.map(t=>({sortValue:Math.random(),v:t})).sort((t,n)=>t.sortValue-n.sortValue).map(t=>t.v),w={a:"UBL",b:"UBR",c:"UFR",d:"UFL",e:"LUB",f:"LUF",g:"LDF",h:"LDB",i:"FUL",j:"FUR",k:"FDR",l:"FDL",m:"RUF",n:"RUB",o:"RDB",p:"RDF",q:"BUR",r:"BUL",s:"BDL",t:"BDR",u:"DFL",v:"DFR",w:"DBR",x:"DBL",y:"DBL",z:"DBL"},ee=r=>{const e=r[0].toLowerCase();return e&&e in w?w[e]:""},pe=r=>r.split("").map(ee),fe=r=>r.map(e=>{const t=e.replaceAll(`
`,"\\n");return t.includes(",")?`"${t.replaceAll('"','""')}"`:t}).join(","),ge=(r,e,t)=>{const m=r.split(";").map(h=>h.trim()).filter(h=>h).filter(h=>!h.startsWith(e));return m.push(t),m.join("; ")},b=60*60*1e3,R=24*b,E=7*R,L=30*R,W=365*R,de=(r,e)=>{const t={},n={},m={},h={0:[],1:[],2:[],3:[]},S={0:[],1:[],2:[],3:[]},c=[],p=[],s=[],i=r.toSorted((l,g)=>g.lastQuizUnix-l.lastQuizUnix),a=r.toSorted((l,g)=>g.lastDrillUnix-l.lastDrillUnix);if(i.length>0){const l=Date.now(),g=i[0].lastQuizUnix,d=new Date(g*1e3),u=i[i.length-1].lastQuizUnix,U=new Date(u*1e3),f=[{label:"1 Year",unixTimestamp:(l-W)/1e3},{label:"6 Months",unixTimestamp:(l-6*L)/1e3},{label:"1 Month",unixTimestamp:(l-L)/1e3},{label:"1 Week",unixTimestamp:(l-E)/1e3},{label:"1 Day",unixTimestamp:(l-R)/1e3},{label:"1 Hour",unixTimestamp:(l-b)/1e3}];for(let o=0;o<f.length;o++)u<f[o].unixTimestamp&&g>f[o].unixTimestamp&&i.push({lastQuizUnix:f[o].unixTimestamp,letterPair:f[o].label,isMarker:!0});i.push({lastQuizUnix:u-1,letterPair:`${U.getFullYear()}-${(U.getMonth()+1).toString().padStart(2,"0")}-${U.getDate().toString().padStart(2,"0")}`,isMarker:!0}),g*1e3>l-R?i.push({lastQuizUnix:i[0].lastQuizUnix+1,letterPair:`${d.getHours()}:${d.getMinutes().toString().padStart(2,"0")}`,isMarker:!0}):i.push({lastQuizUnix:g+1,letterPair:`${d.getFullYear()}-${(d.getMonth()+1).toString().padStart(2,"0")}-${d.getDate().toString().padStart(2,"0")}`,isMarker:!0}),i.sort((o,v)=>{const $=o.lastQuizUnix-v.lastQuizUnix;return $!==0?$:o.letterPair.localeCompare(v.letterPair)});for(let o=1;o<i.length-1;o++)i[o].isMarker&&i[o-1].isMarker&&i[o+1].isMarker&&(i[o].hidden=!0)}if(a.length>0){const l=Date.now(),g=a[0].lastDrillUnix,d=new Date(g*1e3),u=a[a.length-1].lastDrillUnix,U=new Date(u*1e3),f=[{label:"1 Year",unixTimestamp:(l-W)/1e3},{label:"6 Months",unixTimestamp:(l-6*L)/1e3},{label:"1 Month",unixTimestamp:(l-L)/1e3},{label:"1 Week",unixTimestamp:(l-E)/1e3},{label:"1 Day",unixTimestamp:(l-R)/1e3},{label:"1 Hour",unixTimestamp:(l-b)/1e3}];for(let o=0;o<f.length;o++)u<f[o].unixTimestamp&&g>f[o].unixTimestamp&&a.push({lastDrillUnix:f[o].unixTimestamp,letterPair:f[o].label,isMarker:!0});a.push({lastDrillUnix:u-1,letterPair:`${U.getFullYear()}-${(U.getMonth()+1).toString().padStart(2,"0")}-${U.getDate().toString().padStart(2,"0")}`,isMarker:!0}),g*1e3>l-R?a.push({lastDrillUnix:a[0].lastDrillUnix+1,letterPair:`${d.getHours()}:${d.getMinutes().toString().padStart(2,"0")}`,isMarker:!0}):a.push({lastDrillUnix:g+1,letterPair:`${d.getFullYear()}-${(d.getMonth()+1).toString().padStart(2,"0")}-${d.getDate().toString().padStart(2,"0")}`,isMarker:!0}),a.sort((o,v)=>{const $=o.lastDrillUnix-v.lastDrillUnix;return $!==0?$:o.letterPair.localeCompare(v.letterPair)});for(let o=1;o<a.length-1;o++)a[o].isMarker&&a[o-1].isMarker&&a[o+1].isMarker&&(a[o].hidden=!0)}let x=0;for(let l=0;l<24;l++)for(let g=0;g<24;g++){const d=`${String.fromCharCode(97+l)}${String.fromCharCode(97+g)}`;if(K(d,e.bufferPiece)||V(d,e.samePieces))continue;x+=1;const u=r.find(U=>U.letterPair===d);if(u){h[u.memoConfidence]||(h[u.memoConfidence]=[]),u.memo?h[u.memoConfidence].push(d):s.push(d),S[u.commConfidence]||(S[u.commConfidence]=[]),u.commutator?S[u.commConfidence].push(d):p.push(d);const{insert:U,interchange:f,setup:o}=Z(u.commutator);if(!U)continue;t[U]||(t[U]=[]),t[U].push(u.letterPair),n[f]||(n[f]=[]),n[f].push(u.letterPair),m[o]||(m[o]=[]),m[o].push(u.letterPair)}else p.push(d),s.push(d)}r.sort((l,g)=>l.drillTimeMs!==g.drillTimeMs?l.drillTimeMs-g.drillTimeMs:l.letterPair.localeCompare(g.letterPair));const M=r.map(l=>l.drillTimeMs),D=Math.min(...M),P=(Math.max(...M)-D)/10;for(let l=0;l<9;l++){const g=D+l*P,d=D+(l+1)*P,u=r.filter(f=>Math.floor(f.drillTimeMs)>=g&&Math.floor(f.drillTimeMs)<d),U={seconds:[Math.min(...u.map(f=>f.drillTimeMs))/1e3,Math.max(...u.map(f=>f.drillTimeMs))/1e3],letters:u.map(f=>f.letterPair)};c.push(U)}const _=D+9*P,k=r.filter(l=>Math.floor(l.drillTimeMs)>=_),G={seconds:[Math.min(...k.map(l=>l.drillTimeMs))/1e3,Math.max(...k.map(l=>l.drillTimeMs))/1e3],letters:k.map(l=>l.letterPair)};return c.push(G),{inserts:t,interchanges:n,setups:m,memoConfidences:h,missingMemos:s,commConfidences:S,drillSpeedGroups:c,missingComms:p,quizAges:i,drillAges:a,total:x}};export{oe as a,K as b,se as c,ce as d,pe as e,fe as f,ae as g,le as h,V as i,ne as j,ge as k,ue as l,de as m,Z as p,me as s,ie as u};
