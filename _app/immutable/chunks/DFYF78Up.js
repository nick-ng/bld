import"./NZTpNUN0.js";import{o as $e}from"./TiJ0aFaW.js";import{p as ce,o as me,a as O,g as e,q as f,b as s,c as ve,f as c,d as C,r as a,aX as oe,t as w,s as b,af as Fe,K as ke,A as Te,e as se}from"./BXsdZoRn.js";import{s as B}from"./tSrHTpot.js";import{i as Y}from"./BSxnXCi7.js";import{e as q}from"./3SjX1xnl.js";import{s as Z,r as Ae}from"./CxOf_kpF.js";import{s as ue}from"./DKWmIzXd.js";import{d as Ee}from"./DW_c6W7d.js";import{c as Me}from"./i5w7oQmI.js";import{b as je}from"./PBRzJq_N.js";import{b as Le}from"./BlAh2Uqc.js";import{a as H,s as pe}from"./BBUCDAEd.js";import{r as De,g as Ie}from"./BZ9uxqYJ.js";import{p as T}from"./CA4IiTv0.js";import{U as Ue}from"./CzRjdjXF.js";import{b as ge,f as he,g as Re}from"./9_MIyRC0.js";import{o as _e}from"./CMvIGskt.js";import{i as le,b as ie,f as ze,d as Ge,p as Ke}from"./BKtatTih.js";import{s as de}from"./B4ZuMZme.js";import{a as Ne}from"./BeaE2lM_.js";import{F as Oe,S as fe}from"./BWL1kDzn.js";var Ye=c('<div class="hidden cursor-not-allowed border border-gray-500 bg-gray-500 p-0 text-center no-underline lg:block"><div class="mb-1 p-0 leading-none text-gray-500 uppercase"> </div> <div class="h-2 px-0.5 pb-0.5"></div></div>'),qe=c('<div class="block flex-1 rounded-full"></div>'),Be=c('<a><div class="mb-1 p-0 leading-none uppercase"> </div> <div class="flex h-2 flex-row justify-center gap-0.5 px-0.5 pb-0.5"></div></a>');function He(ee,o){ce(o,!0);const U=()=>H(_e,"$optionsStore",R),Q=()=>H(Ne,"$authenticationStore",R),X=()=>H(he,"$flashCardStore",R),[R,g]=pe(),x=60*60*24*U().leitnerRetiredMaxAgeDays,L=m=>{if(typeof m!="number"||Q().isGuest)return"#FFFFFF";const n=Date.now()/1e3-m,_=Math.max(x-n,0)/x,$=Math.ceil(255*_);return`rgb(255, ${230+Math.ceil(25*_)}, ${$})`};let h=f(()=>ge(o.letterPair,o.flashCardType,X())),re=f(()=>[e(h)?.memo?"#ffffff00":"#ff0000ff",e(h)?.commutator?"#ffffff00":"#00aa00ff",e(h)?.image?"#ffffff00":"#0000ffff"]),y=f(()=>le(o.letterPair,U().flashCardTypes[o.flashCardType].samePieces)||ie(o.letterPair,U().flashCardTypes[o.flashCardType].bufferPiece));var S=me(),J=O(S);{var z=m=>{var l=Ye(),n=C(l),_=C(n,!0);a(n),oe(2),a(l),w(()=>B(_,o.letterPair)),s(m,l)},te=m=>{var l=Be(),n=C(l),_=C(n,!0);a(n);var $=b(n,2);q($,23,()=>e(re),(v,F)=>`${F}-${v}`,(v,F)=>{var G=qe();w(()=>de(G,`background-color: ${e(F)};}`)),s(v,G)}),a($),a(l),w((v,F)=>{ue(l,1,`relative block border border-gray-800 p-0 text-center ${e(h)?.isPublic?"underline":"no-underline"}`),de(l,v),Z(l,"href",F),B(_,o.letterPair)},[()=>`background-color:${L(e(h)?.lastDrillUnix)};`,()=>`/flash-cards?t=${o.flashCardType}&f=${o.letterPair.toUpperCase()}`]),s(m,l)};Y(J,m=>{e(y)?m(z):m(te,!1)})}s(ee,S),ve(),g()}var Qe=()=>{T.url.searchParams.delete("f"),Ie(`/flash-cards?${T.url.searchParams.toString()}`)},Xe=c('<div class="w-prose max-w-full"> </div>'),Je=c('<div class="flex w-68 flex-col justify-between rounded border border-gray-300 dark:border-gray-500"><!> <a class="block self-stretch border-t border-gray-300 text-center dark:border-gray-500">Edit</a></div>'),Ve=c(" <!>",1),We=c(" <!>",1),Ze=c('<div class="mt-2 text-center leading-none text-balance"></div>'),er=c('<div class="text-xl"><div class="mt-2 text-center leading-none text-balance"></div> <!></div>'),rr=c('<div class="flashCards lg:min-w-120 svelte-t88dxm"></div> <!>',1),tr=c("<div></div>"),ar=c('<div class="m-auto lg:w-min"><div class="flex flex-row items-end justify-center"><h1>Corner Flash Cards</h1></div> <div class="mb-1 flex flex-row items-center gap-2"><div class="flex min-w-1/2 flex-row"><input class="shrink grow" type="text" autocomplete="off" placeholder="Filter Flash Cards"/><button class="inline-block" type="button">Clear</button></div> <div class="grow-1"></div> <a class="hidden rounded border border-gray-600 px-2 py-0 lg:inline dark:border-gray-300">Export Flash Cards</a></div> <!></div>');function $r(ee,o){ce(o,!0);const U=()=>H(_e,"$optionsStore",X),Q=()=>H(he,"$flashCardStore",X),[X,R]=pe();let g=Fe(ke(T.url.searchParams.get("f")||"")),x=f(()=>T.url.searchParams.get("t")||"corner"),L=f(()=>U().flashCardTypes[e(x)]),h=f(()=>null),re=f(()=>{const r=[];for(let t=0;t<24;t++)for(let d=0;d<24;d++){const i=`${String.fromCharCode(97+t)}${String.fromCharCode(97+d)}`;r.push(i)}return r}),y=f(()=>{const r=e(g).toLowerCase().replaceAll(/[^a-z ]/g," ").replaceAll(/[yz]/g,"x");if(r.length===2)return r[0]===r[1]?[r]:[r,`${r[1]}${r[0]}`];if(r.includes(" ")){const t=r.split(" ").filter(i=>i),d=[];for(let i=0;i<t.length;i++)switch(t[i].length){case 1:{d.push(`${t[i]}${t[i]}`);break}case 2:{d.push(t[i]);break}default:d.push(...t[i].split(""))}return d}return r.split("")}),S=f(()=>e(g)&&e(y).every(r=>r.length===2)?e(y).filter(r=>!(le(r,e(L).samePieces)||ie(r,e(L).bufferPiece))):e(re).filter(r=>e(y).length<1?!0:le(r,e(L).samePieces)||ie(r,e(L).bufferPiece)?!1:e(y).length===1?r.includes(e(y)[0]):e(y).includes(r[0])&&e(y).includes(r[1]))),J=f(()=>e(S).map(r=>ge(r,e(x),Q())));const z=new Date,te=[z.getFullYear(),(z.getMonth()+1).toString().padStart(2,"0"),z.getDate().toString().padStart(2,"0")].join(""),m=localStorage.getItem(Ue)||"user";let l=f(()=>Re(e(x),Q()).sort((r,t)=>r.letterPair.localeCompare(t.letterPair)).map(r=>ze([m,r.letterPair,r.memo,r.image,r.commutator,r.tags,r.type,`${r.commConfidence*4+r.memoConfidence}`,r.isPublic?"1":"0",r.lastQuizUnix.toString()])).join(`
`));Te(()=>{se(g,T.url.searchParams.get("f")||"",!0)}),$e(()=>{const r=t=>{t.key===":"&&(e(h)?.focus(),e(h)?.select())};return document.addEventListener("keypress",r),()=>{document.removeEventListener("keypress",r)}});var n=ar(),_=b(C(n),2),$=C(_),v=C($);Ae(v),Le(v,r=>se(h,r),()=>e(h));var F=b(v);F.__click=[Qe],a($);var G=b($,4);a(_);var be=b(_,2);{var Ce=r=>{var t=Xe(),d=C(t);a(t),w(()=>B(d,`No flash cards match the filter "${e(g)??""}"`)),s(r,t)},xe=r=>{var t=me(),d=O(t);{var i=D=>{var A=rr(),u=O(A);q(u,23,()=>e(S),(E,p)=>`${E}-${p}`,(E,p)=>{var M=Je(),I=C(M);Oe(I,{get letterPair(){return e(p)},get flashCardType(){return e(x)},showCorners:!0,showMemo:!0,showCommutator:!0,showImage:!0,extraClass:"mx-2"});var ae=b(I,2);a(M),w(()=>Z(ae,"href",`/flash-cards/edit?t=${e(x)}&lp=${e(p)}`)),s(E,M)}),a(u);var K=b(u,2);{var Pe=E=>{const p=f(()=>Ge(e(J).map(P=>Ke(P.commutator).expansion).join(" ")));var M=er(),I=C(M);q(I,23,()=>e(p).original,(P,k)=>`${P.move}-${k}`,(P,k,N)=>{oe();var j=Ve(),V=O(j,!0),W=b(V);fe(W,{get move(){return e(k).move},get cancellationType(){return e(k).type}}),w(()=>B(V,e(N)>0?" ":"")),s(P,j)}),a(I);var ae=b(I,2);{var we=P=>{var k=Ze();q(k,23,()=>e(p).simplified,(N,j)=>`${N.move}-${j}`,(N,j,V)=>{oe();var W=We(),ne=O(W,!0),Se=b(ne);fe(Se,{get move(){return e(j).move},get cancellationType(){return e(j).type}}),w(()=>B(ne,e(V)>0?" ":"")),s(N,W)}),a(k),s(P,k)};Y(ae,P=>{e(p).originalCount>e(p).simplifiedCount&&P(we)})}a(M),s(E,M)};Y(K,E=>{e(J).every(p=>p?.commutator)&&E(Pe)})}s(D,A)},ye=D=>{var A=tr();q(A,23,()=>e(S),(u,K)=>`${u}-${K}`,(u,K)=>{He(u,{get letterPair(){return e(K)},get flashCardType(){return e(x)}})}),a(A),w(u=>ue(A,1,u,"svelte-t88dxm"),[()=>Me(["letterPairGrid",!e(g)&&"letterPairGridColumns"].filter(u=>u).join(" "))]),s(D,A)};Y(d,D=>{e(S).length<=25?D(i):D(ye,!1)},!0)}s(r,t)};Y(be,r=>{e(S).length===0?r(Ce):r(xe,!1)})}a(n),w(r=>{Z(G,"href",r),Z(G,"download",`v2-${te}-000000-log.csv`)},[()=>`data:text/csv;charset=utf-8,${encodeURIComponent(e(l))}`]),je(v,()=>e(g),r=>{se(g,r.replaceAll(/,/g," ").replaceAll(/[^a-z ()]/gi,"").replaceAll(/ +/g," ").toUpperCase(),!0),T.url.searchParams.set("f",e(g)),De(`/flash-cards?${T.url.searchParams.toString()}`,T.state)}),s(ee,n),ve(),R()}Ee(["click"]);export{$r as A};
