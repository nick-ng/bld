import"../chunks/NZTpNUN0.js";import{p as It,A as te,f as g,d as l,r as o,s as n,t as z,b as v,c as Ft,g as s,af as f,e as a,q as M,aX as D,aY as wt,o as ee,a as ae}from"../chunks/BXsdZoRn.js";import{i as P}from"../chunks/BSxnXCi7.js";import{p as St}from"../chunks/CA4IiTv0.js";import{A as re}from"../chunks/DFYF78Up.js";import{o as se}from"../chunks/TiJ0aFaW.js";import{s as ot}from"../chunks/tSrHTpot.js";import{r as C,s as I,a as jt}from"../chunks/CxOf_kpF.js";import{s as le}from"../chunks/DKWmIzXd.js";import{d as oe,e as ie}from"../chunks/DW_c6W7d.js";import{c as ne}from"../chunks/i5w7oQmI.js";import{b as it,a as ce,c as ue}from"../chunks/PBRzJq_N.js";import{b as me}from"../chunks/BlAh2Uqc.js";import{a as Tt,s as de}from"../chunks/BBUCDAEd.js";import{f as fe}from"../chunks/CMvIGskt.js";import{u as ve,e as _e,a as be,j as pe,g as he}from"../chunks/BKtatTih.js";import{l as ge,c as xe,a as ke,b as zt,u as ye,f as Ce}from"../chunks/9_MIyRC0.js";import{C as Pe}from"../chunks/BcZN5Ja3.js";import{I as we}from"../chunks/BWL1kDzn.js";var Se=g('<div class="text-center"> </div>'),je=(d,e)=>{a(e,!0)},Te=(d,e)=>{a(e,!0)},ze=(d,e,m,_,p,w)=>{a(e,!0),s(m)?(a(m,!1),a(_,s(p),!0)):(a(m,!0),a(_,`${s(w)}.emoji`))},Ie=g('<div>Emoji</div> <div class="line-through">Image</div>',1),Fe=g('<div>Image</div> <div class="line-through">Emoji</div>',1),Ae=(d,e,m,_)=>{a(e,!0),a(m,d.currentTarget.value,!0),a(_,`${s(m)}.emoji`)},Ue=g('<input class="w-full" type="text" autocomplete="off" name="emoji"/>'),Ee=(d,e)=>{a(e,!0)},Le=g('<input class="max-w-64" type="file" name="image" alt="Choose Image" accept="image/*"/>'),De=(d,e)=>{a(e,!0)},Me=(d,e)=>{a(e,!0)},Re=()=>{history.back()},We=(d,e,m)=>{s(e)&&(a(e,!1),m())},Oe=g('<form><table class="flash-card-editor mx-auto border-separate border-spacing-x-1 svelte-1kbm3sz"><tbody><tr><td class="text-right svelte-1kbm3sz"><a href="https://bestsiteever.net/colpi/" target="pux_bld_colpi">Memo</a></td><td class="svelte-1kbm3sz"><input class="w-full" type="text" autocomplete="off" name="memo"/></td></tr><tr><td class="text-right svelte-1kbm3sz"><a target="pux_bld_blddb_comm">Commutator</a></td><td class="svelte-1kbm3sz"><input class="w-full" type="text" autocomplete="off" name="commutator"/></td></tr><tr><td class="text-right svelte-1kbm3sz"><button type="button" class="cannot-hover:py-2 ml-auto block rounded border border-gray-600 px-2 py-0 dark:border-gray-300"><!></button></td><td class="svelte-1kbm3sz"><input type="hidden" name="imageUrl"/> <!> <label class="mx-auto mt-0.5 block"><!></label></td></tr><tr><td class="text-right svelte-1kbm3sz">Tags</td><td class="svelte-1kbm3sz"><input class="w-full" type="text" autocomplete="off" name="tags"/></td></tr><tr><td class="text-right svelte-1kbm3sz"><label for="isPublicCheckbox"><!> Public</label></td><td class="svelte-1kbm3sz"><label class="inline-block w-full" for="isPublicCheckbox"><input type="checkbox" name="isPublic" id="isPublicCheckbox"/> <!></label></td></tr></tbody></table> <div class="mt-1 flex w-full flex-row justify-between gap-8"><button class="flex-grow" type="button">Back</button> <button class="flex-grow" type="button">Reset</button> <button class="flex-grow">Save</button></div> <details class="can-hover:block hidden"><summary>Debug</summary> <pre> </pre></details></form>'),Je=g('<div class="mx-auto max-w-prose"><h2 class="text-center uppercase"> </h2> <div class="mb-1 text-center"><!></div> <!></div>');function Ne(d,e){It(e,!0);const m=()=>Tt(Ce,"$flashCardStore",p),_=()=>Tt(xe,"$flashCardStoreStatus",p),[p,w]=de();let x=f(null),k=f(null),c=f(!1),R=f(""),W=f(""),O=f(""),y=f(!1),F=f(""),nt=f(""),S=f(""),A=f(!1);const At=()=>{switch(he()){case"win":return"Win + . or Win + ;";case"mac":return"Control + Command + Space";default:return"Enter an Emoji"}},ct=async()=>{if(!s(c)){await ke();const i=zt(e.letterPair,e.flashCardType,m());a(R,i.memo,!0),a(W,i.commutator,!0),a(O,i.tags,!0),a(y,i.isPublic,!0),a(S,i.image,!0),i.image.endsWith(".emoji")?(a(A,!0),a(F,i.image.replace(/\.emoji$/,""),!0)):a(nt,i.image,!0)}};te(()=>{ct()});const Ut=(i,u)=>u.endsWith(".emoji")?u:i&&i.length>0?window.URL.createObjectURL(i[0]):u,Et=()=>{ct(),s(k)&&(s(k).value="",a(x,null))};se(()=>{const i=new AbortController;let u=!1;return(async()=>(await ge(e.letterPair,e.flashCardType,i.signal),u=!0))(),()=>{u||i.abort()}});var J=Je(),N=l(J),Lt=l(N,!0);o(N);var q=n(N,2),Dt=l(q);Pe(Dt,{get letterPair(){return e.letterPair}}),o(q);var Mt=n(q,2);{var Rt=i=>{var u=Se(),j=l(u,!0);o(u),z(U=>ot(j,U),[()=>ve(_().message)]),v(i,u)},Wt=i=>{var u=Oe(),j=l(u),U=l(j),B=l(U),ut=n(l(B)),H=l(ut);C(H),H.__change=[je,c],o(ut),o(B);var X=n(B),Y=l(X),Ot=l(Y);o(Y);var mt=n(Y),G=l(mt);C(G),G.__change=[Te,c],o(mt),o(X);var K=n(X),Q=l(K),V=l(Q);V.__click=[ze,c,A,S,nt,F];var Jt=l(V);{var Nt=t=>{var r=Ie();D(2),v(t,r)},qt=t=>{var r=Fe();D(2),v(t,r)};P(Jt,t=>{s(A)?t(Nt):t(qt,!1)})}o(V),o(Q);var dt=n(Q),Z=l(dt);C(Z);var ft=n(Z,2);{var Bt=t=>{var r=Ue();C(r),r.__input=[Ae,c,F,S],z(b=>{I(r,"id",`${e.letterPair}-image`),I(r,"placeholder",b),jt(r,s(F))},[At]),v(t,r)},Ht=t=>{var r=Le();r.__change=[Ee,c],me(r,b=>a(k,b),()=>s(k)),z(()=>I(r,"id",`${e.letterPair}-image`)),ue(r,()=>s(x),b=>a(x,b)),v(t,r)};P(ft,t=>{s(A)?t(Bt):t(Ht,!1)})}var $=n(ft,2),Xt=l($);{let t=M(()=>Ut(s(x),s(S))),r=M(()=>`${e.letterPair.toUpperCase()} visualisation`);we(Xt,{get imageUri(){return s(t)},get alt(){return s(r)}})}o($),o(dt),o(K);var tt=n(K),vt=n(l(tt)),et=l(vt);C(et),et.__change=[De,c],o(vt),o(tt);var at=n(tt),rt=l(at),_t=l(rt),Yt=l(_t);{var Gt=t=>{var r=wt("ðŸ‘€");v(t,r)};P(Yt,t=>{s(y)&&t(Gt)})}D(),o(_t),o(rt);var bt=n(rt),pt=l(bt),E=l(pt);C(E),E.__change=[Me,c];var Kt=n(E,2);{var Qt=t=>{var r=wt("ðŸ‘€");v(t,r)};P(Kt,t=>{s(y)&&t(Qt)})}o(pt),o(bt),o(at),o(U),o(j);var st=n(j,2),ht=l(st);ht.__click=[Re];var Vt=n(ht,2);Vt.__click=[We,c,Et],D(2),o(st);var gt=n(st,2),xt=n(l(gt),2),Zt=l(xt,!0);o(xt),o(gt),o(u),z((t,r)=>{I(Ot,"href",t),jt(Z,s(S)),I($,"for",`${e.letterPair}-image`),le(at,1,ne(s(y)?"font-bold text-red-800 dark:text-red-200":"")),ot(Zt,r)},[()=>`https://v2.blddb.net/corner?position=${_e(`c${e.letterPair}`).join("-")}&mode=manmade`,()=>JSON.stringify(zt(e.letterPair,e.flashCardType,m()),null,2)]),ie("submit",u,async t=>{t.preventDefault(),a(c,!1);const r=new FormData,b=[...t.currentTarget];for(let T=0;T<b.length;T++){const h=b[T];if(h instanceof HTMLInputElement){const L=h.getAttribute("name"),$t=h.getAttribute("type");if(!L||!$t)continue;switch(h.getAttribute("type")){case"file":{const lt=h.files;if(!lt)break;const Pt=lt[lt.length-1];if(!Pt)break;r.set(L,Pt);break}case"checkbox":{r.set(L,h.checked?"1":"0");break}default:r.set(L,h.value)}}}const kt=await be(pe("flash-cards",e.letterPair),{method:"PUT",body:r});if(!kt)return;const yt=await kt.json(),Ct=fe.safeParse(yt);if(Ct.success){const{data:T}=Ct;ye(T),history.back()}else console.error("wrong",yt)}),it(H,()=>s(R),t=>a(R,t)),it(G,()=>s(W),t=>a(W,t)),it(et,()=>s(O),t=>a(O,t)),ce(E,()=>s(y),t=>a(y,t)),v(i,u)};P(Mt,i=>{_().status!=="loaded"?i(Rt):i(Wt,!1)})}o(J),z(()=>ot(Lt,e.letterPair)),v(d,J),Ft(),w()}oe(["change","click","input"]);function na(d,e){It(e,!0);let m=M(()=>St.url.searchParams.get("lp")),_=M(()=>St.url.searchParams.get("t")||"corner");var p=ee(),w=ae(p);{var x=c=>{Ne(c,{get letterPair(){return s(m)},get flashCardType(){return s(_)}})},k=c=>{re(c,{})};P(w,c=>{s(m)?.length==2?c(x):c(k,!1)})}v(d,p),Ft()}export{na as component};
