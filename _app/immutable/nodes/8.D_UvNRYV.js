import{f as P,a as g,c as ve,t as de}from"../chunks/ChvGfjHK.js";import{p as N,b as w,ad as M,c as r,g as t,aM as y,r as i,s as u,t as O,a as V,n as le,f as be,V as oe}from"../chunks/C5K1Yg5B.js";import{s as ne,a as Y}from"../chunks/Bwczmf3X.js";import{p as he}from"../chunks/B5WL_Ogo.js";import{g as pe}from"../chunks/WMr84jBD.js";import{I as _e,a as xe,s as ye,b as Pe,l as ke}from"../chunks/DH80SLoI.js";import{s as J}from"../chunks/CliCnMxv.js";import{i as B}from"../chunks/DaHJMf7G.js";import{e as we}from"../chunks/BVS0q2To.js";import{s as I,r as K,b as ce,a as je}from"../chunks/Bqkc9qf9.js";import{s as Se}from"../chunks/DcH0Rxn3.js";import{d as Z,a as U,e as ze}from"../chunks/Co33GQ6k.js";import{b as Ce}from"../chunks/D8pj6tNt.js";import{o as Oe}from"../chunks/CZvxKhKB.js";import{c as Ue,a as Te,j as Ie,g as Ee,b as De}from"../chunks/B_Hhx7_u.js";var Me=P('<div>Emoji</div> <div class="line-through">Image</div>',1),Be=P('<div>Image</div> <div class="line-through">Emoji</div>',1),Fe=P('<input class="w-full px-0.5" type="text" autocomplete="off" name="emoji"/>'),Re=P('<input class="max-w-64" type="file" name="image" alt="Choose Image" accept="image/*"/>'),We=P('<tr><td class="text-right align-top"><button type="button" class="cannot-hover:py-2 ml-auto block rounded border border-gray-600 px-2 py-0 dark:border-gray-300"><!></button></td><td><!> <label class="mx-auto mt-0.5 block"><!></label></td></tr>');function Je(j,e){N(e,!0);let m=y(()=>e.imageUri.endsWith(".emoji")),p=M(".emoji"),_=M(""),v=M("Enter an Emoji");switch(Ue()){case"win":{w(v,"Win + . or Win + ;");break}case"mac":{w(v,"Control + Command + Space");break}}var a=We(),o=r(a),d=r(o),S=r(d);{var z=s=>{var l=Me();le(2),g(s,l)},k=s=>{var l=Be();le(2),g(s,l)};B(S,s=>{t(m)?s(z):s(k,!1)})}i(d),i(o);var x=u(o),T=r(x);{var q=s=>{var l=Fe();K(l),O(f=>{I(l,"id",`${e.speffzPair}-image`),I(l,"placeholder",t(v)),ce(l,f)},[()=>e.imageUri.replace(/\.emoji$/,"")]),U("input",l,f=>{e.imageChanged(`${f.currentTarget.value}.emoji`)}),g(s,l)},A=s=>{var l=Re();O(()=>I(l,"id",`${e.speffzPair}-image`)),U("change",l,async f=>{const E=new FormData;if(!f.currentTarget.files)return;const D=f.currentTarget.files[f.currentTarget.files.length-1];if(!D)return;E.set("image",D);const F=await(await Te(Ie("images",e.speffzPair),{method:"POST",body:E})).text();e.imageChanged(F)}),g(s,l)};B(T,s=>{t(m)?s(q):s(A,!1)})}var b=u(T,2),h=r(b);{let s=y(()=>`${e.speffzPair.toUpperCase()} visualisation`);_e(h,{get imageUri(){return e.imageUri},get alt(){return t(s)}})}i(b),i(x),i(a),O(()=>I(b,"for",`${e.speffzPair}-image`)),U("click",d,()=>{t(m)?(w(p,e.imageUri,!0),e.imageChanged(t(_))):(w(_,e.imageUri,!0),e.imageChanged(t(p)))}),g(j,a),V()}Z(["click","input","change"]);var Ke=P('<tr><td class="text-right"><a target="pux_bld_blddb_comm"> </a></td><td><input class="w-full px-0.5" type="text" autocomplete="off"/></td></tr>');function Ne(j,e){N(e,!0);let m=y(()=>Ee(e.speffzPair,e.buffer));var p=ve(),_=be(p);{var v=a=>{var o=Ke(),d=r(o),S=r(d),z=r(S,!0);i(S),i(d);var k=u(d),x=r(k);K(x),i(k),i(o),O(()=>{I(S,"href",t(m)),J(z,e.buffer),I(x,"name",`${e.buffer}-moves`),ce(x,e.moves)}),U("input",x,T=>{e.movesChanged(T.currentTarget.value)}),g(a,o)};B(_,a=>{t(m)&&a(v)})}g(j,p),V()}Z(["input"]);var Ve=P("<div> </div>"),qe=P('<form><table class="flash-card-editor mx-auto border-separate border-spacing-x-1 border-spacing-y-0.5"><tbody><tr><td class="text-right"><a href="https://bestsiteever.net/colpi/" target="pux_bld_colpi">Memo</a></td><td class="flex flex-row"><input class="w-full px-0.5" type="text" autocomplete="off" name="memo"/></td></tr><!><!><tr><td class="text-right"><label for="isPublicCheckbox">Public</label></td><td><label class="inline-block w-full" for="isPublicCheckbox"><input type="checkbox" name="isPublic" id="isPublicCheckbox"/> <!></label></td></tr></tbody></table> <div class="mt-1 flex w-full flex-row justify-between gap-8"><button class="flex-grow" type="button">Back</button> <button class="flex-grow" type="button">Reset</button> <button class="flex-grow">Save</button></div> <details class="can-hover:block hidden"><summary>Debug</summary> <pre> </pre></details></form>'),Ae=P('<div class="mx-auto max-w-prose"><h2 class="text-center uppercase"> </h2> <!></div>');function Ge(j,e){N(e,!0);const m=()=>Y(xe,"$letterPairStoreStatus",_),p=()=>Y(Oe,"$optionsStore",_),[_,v]=ne();let a=M(oe({})),o=M(oe({})),d=y(()=>Object.keys(t(a)).length>0||Object.keys(t(o)).length>0),S=y(()=>t(d)?`${e.letterPair.speffz_pair} [+]`:m().status==="saving"?`${e.letterPair.speffz_pair}...`:e.letterPair.speffz_pair);var z=Ae(),k=r(z),x=r(k,!0);i(k);var T=u(k,2);{var q=b=>{var h=Ve(),s=r(h,!0);i(h),O(()=>J(s,m().message)),g(b,h)},A=b=>{var h=qe(),s=r(h),l=r(s),f=r(l),E=u(r(f)),D=r(E);K(D),i(E),i(f);var G=u(f);we(G,1,()=>De(p().chosenBuffers),c=>c,(c,n)=>{{let ie=y(()=>t(o)[t(n)]?.moves??(e.letterPair.algorithms[t(n)]?.moves||""));Ne(c,{get speffzPair(){return e.letterPair.speffz_pair},get buffer(){return t(n)},get moves(){return t(ie)},movesChanged:W=>{t(o)[t(n)]={speffz_pair:e.letterPair.speffz_pair,buffer:t(n),moves:W}}})}});var F=u(G);{let c=y(()=>t(a).image??(e.letterPair.image||""));Je(F,{get speffzPair(){return e.letterPair.speffz_pair},get imageUri(){return t(c)},imageChanged:n=>{t(a).image=n}})}var L=u(F),H=u(r(L)),$=r(H),R=r($);K(R);var ue=u(R,2);{var me=c=>{var n=de("ðŸ‘€");g(c,n)};B(ue,c=>{(t(a).is_public??e.letterPair.is_public)&&c(me)})}i($),i(H),i(L),i(l),i(s);var Q=u(s,2),ee=r(Q),te=u(ee,2),fe=u(te,2);i(Q);var ae=u(Q,2),re=u(r(ae),2),ge=r(re,!0);i(re),i(ae),i(h),O((c,n)=>{Se(H,1,`px-1 ${t(a).is_public??e.letterPair.is_public?"bg-red-800":""}`),je(R,t(a).is_public??e.letterPair.is_public),fe.disabled=c,J(ge,n)},[()=>Object.keys(t(a)).length===0&&Object.keys(t(o)).length===0,()=>JSON.stringify(e.letterPair,null,2)]),ze("submit",h,async c=>{if(c.preventDefault(),!t(d)){history.back();return}try{const n=Object.entries(t(o)).map(async([C,X])=>{if(!X||Object.keys(X).length===0)return;const se=await ye({speffz_pair:e.letterPair.speffz_pair,buffer:C,...X},!1);if(typeof se=="string")return se;t(o)[C]={}});Object.keys(t(a)).length>0&&n.push((async()=>{const C=await Pe({speffz_pair:e.letterPair.speffz_pair,...t(a)},!1);if(typeof C=="string")return C;w(a,{},!0)})());const W=(await Promise.all(n)).filter(C=>typeof C=="string");W.length>0?console.error("error saving these items:",W):(w(o,{},!0),history.back())}catch(n){console.error("error saving",n)}}),Ce(D,()=>t(a).words??e.letterPair.words,c=>{t(a).words=c}),U("change",R,()=>{t(a).is_public=!(t(a).is_public??e.letterPair.is_public)}),U("click",ee,()=>{history.back()}),U("click",te,()=>{w(a,{},!0),w(o,{},!0)}),g(b,h)};B(T,b=>{m().status!=="loaded"&&m().status!=="saving"?b(q):b(A,!1)})}i(z),O(()=>J(x,t(S))),g(j,z),V(),v()}Z(["change","click"]);function nt(j,e){N(e,!0);const m=()=>Y(ke,"$letterPairStore",p),[p,_]=ne();let v=y(()=>he.url.searchParams.get("sp")||""),a=y(()=>m()[t(v)]??{...pe(t(v)),algorithms:{}});Ge(j,{get letterPair(){return t(a)}}),V(),_()}export{nt as component};
