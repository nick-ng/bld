import{f as x,a as f,t as Bt,w as Et,c as Ct}from"../chunks/ChvGfjHK.js";import{p as mt,t as Y,g as t,ad as h,b as i,a as _t,V as Ht,f as bt,c as r,r as a,s as o,aM as V,bf as Dt,af as Mt,P as at,n as Nt}from"../chunks/C5K1Yg5B.js";import{s as F}from"../chunks/CliCnMxv.js";import{i as G}from"../chunks/DaHJMf7G.js";import{e as Pt}from"../chunks/BVS0q2To.js";import{r as E,b as yt,s as ot,a as jt}from"../chunks/Bqkc9qf9.js";import{d as At,e as ut,a as T}from"../chunks/Co33GQ6k.js";import{s as Lt}from"../chunks/CfrceTM-.js";import{b as rt}from"../chunks/D8pj6tNt.js";import{b as qt}from"../chunks/BdPmDRBi.js";import{b as Yt}from"../chunks/_bAq7S1v.js";import{s as Ft,a as Gt,b as It,d as Rt}from"../chunks/Bwczmf3X.js";import{m as Jt}from"../chunks/WMr84jBD.js";import{m as lt}from"../chunks/DjkpVNvv.js";import{d as Vt,h as Ot,e as Kt,f as Ut}from"../chunks/B_Hhx7_u.js";import{s as Qt}from"../chunks/DcH0Rxn3.js";import{c as Wt}from"../chunks/i5w7oQmI.js";import{o as zt}from"../chunks/Bk01Ho5O.js";import{k as Xt}from"../chunks/qLy5ufeV.js";import{h as Zt}from"../chunks/orLAHixk.js";import{p as $t}from"../chunks/C6H1YX2b.js";var te=x('<input type="text"/>');function ee(A,l){mt(l,!0);let e=h("");var v=te();E(v),Y(g=>{Qt(v,1,Wt(l.classes||"")),yt(v,g)},[()=>t(e)||Vt(l.value)]),ut("focus",v,()=>{i(e,Vt(l.value),!0)}),T("change",v,g=>{i(e,g.currentTarget.value,!0)}),ut("blur",v,()=>{l.onChange(Ot(t(e))),i(e,""),typeof l.afterBlur=="function"&&setTimeout(l.afterBlur,0)}),f(A,v),_t()}At(["change"]);var ae=x('<a target="pux-mbld-scramble">Scramble</a>'),re=x('<tr><td>Reason</td><td><textarea class="w-full resize-y px-0.5"></textarea></td></tr>'),le=x('<tr class="bg-slate-200"><td colspan="2"> </td></tr> <tr><td>Pack</td><td><input class="w-full px-0.5" type="text"/></td></tr> <tr><td>Exec Start</td><td><!> <button class="inline"> </button></td></tr> <tr class="group"><td><!></td><td class="relative"><input class="w-full px-0.5" type="text"/> <div class="top-0 left-0 hidden group-hover:visible"> </div></td></tr> <tr><td><label class="block">DNF</label></td><td><label class="block"><input type="checkbox"/></label></td></tr> <!>',1);function oe(A,l){mt(l,!0);let e=h(Ht({})),v=V(()=>t(e).scramble??l.cube.scramble),g=V(()=>t(v)&&`https://alpha.twizzle.net/edit/?setup-alg=${encodeURIComponent(t(v))}`);const _=()=>{l.onSave({...l.cube,...t(e)}),i(e,{},!0)};var b=le(),d=bt(b),I=r(d),z=r(I);a(I),a(d);var C=o(d,2),P=o(r(C)),u=r(P);E(u),a(P),a(C);var p=o(C,2),L=o(r(p)),H=r(L);{let c=V(()=>t(e).exec_start_s??l.cube.exec_start_s);ee(H,{classes:"px-0.5 w-16 text-right",get value(){return t(c)},onChange:y=>{t(e).exec_start_s=y},afterBlur:_})}var k=o(H,2),st=r(k,!0);a(k),a(L),a(p);var M=o(p,2),B=r(M),it=r(B);{var ft=c=>{var y=ae();Y(()=>ot(y,"href",t(g))),f(c,y)},pt=c=>{var y=Bt("Scramble");f(c,y)};G(it,c=>{t(v)?c(ft):c(pt,!1)})}a(B);var gt=o(B),N=r(gt);E(N);var J=o(N,2),nt=r(J,!0);a(J),a(gt),a(M);var O=o(M,2),K=r(O),kt=r(K);a(K);var dt=o(K),R=r(dt),Q=r(R);E(Q),a(R),a(dt),a(O);var wt=o(O,2);{var St=c=>{var y=re(),ht=o(r(y)),s=r(ht);Dt(s),a(ht),a(y),Y(()=>yt(s,t(e).dnf_reason??l.cube.dnf_reason)),T("change",s,m=>{t(e).dnf_reason=m.currentTarget.value}),ut("blur",s,_),f(c,y)};G(wt,c=>{l.cube.is_dnf&&c(St)})}Y(c=>{F(z,`Cube ${l.index+1}`),yt(u,t(e).pack??l.cube.pack),F(st,c),yt(N,t(e).scramble??l.cube.scramble),F(nt,l.cube.scramble),ot(kt,"for",`dnf-cube-${l.index}`),ot(R,"for",`dnf-cube-${l.index}`),ot(Q,"id",`dnf-cube-${l.index}`),jt(Q,l.cube.is_dnf)},[()=>Vt(l.cube.exec_start_s)]),T("change",u,c=>{t(e).pack=c.currentTarget.value}),ut("blur",u,_),T("click",k,()=>{l.onSeekRequest(l.cube.exec_start_s)}),T("change",N,c=>{t(e).scramble=c.currentTarget.value}),ut("blur",N,_),T("change",Q,()=>{t(e).is_dnf=!l.cube.is_dnf,_()}),f(A,b),_t()}At(["change","click"]);var se=Et(x('<script src="https://www.youtube.com/iframe_api"><\/script><!>',1)),ie=x('<div class="h-full w-full"><div></div></div>');function ne(A,l){mt(l,!0);let e=$t(l,"player",15);const v="youtube-player";zt(()=>{function b(){e(new YT.Player(v,{height:"100%",width:"100%",videoId:l.initialVideoId,playerVars:{autoplay:0}}))}window.YT?b():window.onYouTubeIframeAPIReady=b});var g=ie();Zt("1phn24x",b=>{var d=se();o(bt(d)),f(b,d)});var _=r(g);ot(_,"id",v),a(g),f(A,g),_t()}var de=x('<video class="h-full w-full" controls=""><track kind="captions" src=""/></video>',2);function ce(A,l){mt(l,!0);let e=h(null),v=h(null),g=V(()=>Kt(l.videoUrl)),_=V(()=>t(g).id),b=V(()=>t(g).platform);const d=u=>{switch(t(b)){case"youtube":{t(e)&&t(e).seekTo(u,!0);return}case"file":{t(v)&&(t(v).currentTime=u);return}}};zt(()=>{l.getSeekTo(d)});var I=Ct(),z=bt(I);{var C=u=>{var p=Ct(),L=bt(p);Xt(L,()=>l.videoUrl,H=>{ne(H,{get initialVideoId(){return t(_)},get player(){return t(e)},set player(k){i(e,k,!0)}})}),f(u,p)},P=u=>{var p=de();Yt(p,L=>i(v,L),()=>t(v)),Y(()=>ot(p,"src",l.videoUrl)),f(u,p)};G(z,u=>{t(b)==="youtube"?u(C):t(b)==="file"&&u(P,1)})}f(A,I),_t()}var ve=x('<option disabled="">No attempts. Generate or import scrambles.</option>'),ue=x("<option> </option>"),be=x('<table class="border-separate border-spacing-2"><tbody><tr><td>Date</td><td> </td></tr><tr><td>Local Video Link</td><td><input type="text"/></td></tr><tr><td>YouTube Link</td><td><input type="text"/></td></tr></tbody></table> <table class="w-full border-separate border-spacing-x-2 border-spacing-y-0.5"><tbody></tbody></table>',1),me=x('<p>You need to generate and save some MBLD scrambles first.</p> <p><a href="/mbld/scramble">Generate scrambles</a></p>',1),_e=x('<div class="m-3"><!> <h2>Import Scrambles</h2> <p>Enter the date of the attempt and paste scrambles then click "Import"</p> <div class="flex flex-row gap-2"><label>Date: <input type="date"/></label> <label>Time: <input type="time"/></label> <span class="grow"></span> <span> </span></div> <textarea class="mt-1 h-32 w-full resize-y px-0.5"></textarea> <button type="button">Import</button> <h2>Import Attempt</h2> <textarea class="mt-1 h-32 w-full resize-y px-0.5"></textarea> <button type="button">Import Attempt</button></div>'),fe=x('<div><div class="space-between mb-1 flex flex-row gap-1"><select class="px-1"><option>Import</option><!><!></select> <button>Copy Attempt</button> <button>Copy Scrambles</button> <button>Import</button> <a target="_blank" href="https://namisama269.github.io/scramble-finder/">Scramble Finder</a> <div> </div></div> <div class="flex flex-row justify-start gap-2"><div class="relative overflow-y-scroll"><!></div> <div class="grow"><!></div></div></div>');function Ee(A,l){mt(l,!0);const e=()=>Gt(lt,"$mbldStore",v),[v,g]=Ft();let _=h(""),b=h(1),d=V(()=>t(b)-1),I=h(null),z=h("50vh"),C=h(null),P=h(""),u=h(""),p=h(""),L=V(()=>t(u)?new Date(`${t(u)}T${t(p)||"00:00"}:00.000`):new Date),H=V(()=>e()[t(d)].local_video_link||e()[t(d)]?.youtube_link),k=h("");Mt(()=>{setTimeout(()=>{t(I)&&t(z)==="50vh"&&i(z,`calc(100vh - ${t(I).getBoundingClientRect().top}px)`)},10)});var st=fe(),M=r(st),B=r(M),it=r(B),ft={},pt=o(it);{var gt=s=>{var m=ve();m.value=m.__value="",f(s,m)};G(pt,s=>{e().length===0&&s(gt)})}var N=o(pt);Pt(N,3,()=>e().slice(-20),s=>s.date,(s,m,D)=>{var w=ue(),j=r(w,!0);a(w);var U={};Y(q=>{F(j,q),U!==(U=t(D)+1)&&(w.value=w.__value=t(D)+1)},[()=>Ut(t(m).date)]),f(s,w)}),a(B);var J=o(B,2),nt=o(J,2),O=o(nt,2),K=o(O,4),kt=r(K,!0);a(K),a(M);var dt=o(M,2),R=r(dt),Q=r(R);{var wt=s=>{var m=be(),D=bt(m),w=r(D),j=r(w),U=o(r(j)),q=r(U,!0);a(U),a(j);var W=o(j),X=o(r(W)),ct=r(X);E(ct),a(X),a(W);var vt=o(W),xt=o(r(vt)),Z=r(xt);E(Z),a(xt),a(vt),a(w),a(D);var $=o(D,2),tt=r($);Pt(tt,7,()=>e()[t(d)].cubes,(S,n)=>`${n}-cube`,(S,n,et)=>{oe(S,{get index(){return t(et)},get cube(){return t(n)},onSave:Tt=>{It(lt,at(e)[t(d)].cubes[t(et)]=Tt,at(e))},onSeekRequest:Tt=>{t(C)&&t(C)(Tt)}})}),a(tt),a($),Y(S=>F(q,S),[()=>Ut(e()[t(d)].date)]),rt(ct,()=>e()[t(d)].local_video_link,S=>It(lt,at(e)[t(d)].local_video_link=S,at(e))),rt(Z,()=>e()[t(d)].youtube_link,S=>It(lt,at(e)[t(d)].youtube_link=S,at(e))),f(s,m)},St=s=>{const m=V(()=>t(P).split(`
`).map(n=>n.trim()).filter(n=>n.length>0));var D=_e(),w=r(D);{var j=n=>{var et=me();Nt(2),f(n,et)};G(w,n=>{e().length===0&&n(j)})}var U=o(w,6),q=r(U),W=o(r(q));E(W),a(q);var X=o(q,2),ct=o(r(X));E(ct),a(X);var vt=o(X,4),xt=r(vt,!0);a(vt),a(U);var Z=o(U,2);Dt(Z);var $=o(Z,2),tt=o($,4);Dt(tt);var S=o(tt,2);a(D),Y(n=>{F(xt,n),$.disabled=t(m).length===0,S.disabled=t(k).length===0},[()=>t(L).toLocaleString()]),rt(W,()=>t(u),n=>i(u,n)),rt(ct,()=>t(p),n=>i(p,n)),rt(Z,()=>t(P),n=>i(P,n)),T("click",$,()=>{t(m).length!==0&&(Rt(lt,[{date:t(L),youtube_link:"",offset_s:0,chapters:"",time_s:0,scrambles:t(m),cubes:t(m).map(()=>({dnf_reason:"",exec_start_s:0,is_dnf:!1,pack:"",scramble:""}))},...e()]),i(u,""),i(p,""),i(P,""),i(b,1))}),rt(tt,()=>t(k),n=>i(k,n)),T("click",S,()=>{try{const n=JSON.parse(t(k)),et=Jt.parse(n);Rt(lt,[et,...e()]),i(k,""),i(b,1)}catch(n){i(_,`Error importing attempt: ${n}`)}}),f(s,D)};G(Q,s=>{e()[t(d)]?s(wt):s(St,!1)})}a(R),Yt(R,s=>i(I,s),()=>t(I));var c=o(R,2),y=r(c);{var ht=s=>{ce(s,{get videoUrl(){return t(H)},getSeekTo:m=>{i(C,m,!0)}})};G(y,s=>{t(H)&&s(ht)})}a(c),a(dt),a(st),Y(()=>{ft!==(ft=e().length===0?1:-1)&&(it.value=it.__value=e().length===0?1:-1),J.disabled=!e()[t(d)],nt.disabled=!e()[t(d)],F(kt,t(_)),Lt(R,`max-height:${t(z)};`),Lt(c,`max-height:${t(z)};`)}),qt(B,()=>t(b),s=>i(b,s)),T("click",J,async()=>{i(_,"Please wait"),await navigator.clipboard.writeText(JSON.stringify(e()[t(d)],null,2)),i(_,"Attempt copied to clipboard")}),T("click",nt,async()=>{i(_,"Please wait"),await navigator.clipboard.writeText(e()[t(d)]?.scrambles.join(`
`)),i(_,`${e()[t(d)]?.scrambles.length} scrambles copied to clipboard`)}),T("click",O,()=>{i(b,e().length===0?1:-1,!0)}),f(A,st),_t(),g()}At(["click"]);export{Ee as component};
